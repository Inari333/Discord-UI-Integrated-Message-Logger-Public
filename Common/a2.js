const e="https://inari-discord-api-emhndjbwfqc4enfz.canadaeast-01.azurewebsites.net",t=Object.freeze({FREE:0,BASIC:1,PREMIUM:2});async function n(e,t){const n=await chrome.runtime.sendMessage({type:"PAY_FROM_DISCORD_MESSAGE_LOGGER",planLevel:e,key:I});n?.success?window.open(n.url,"_blank"):t&&t()}async function s(e,t){const n=await chrome.runtime.sendMessage({type:"KEY_CHECK_FROM_DISCORD_MESSAGE_LOGGER",key:e});return n?.success?n.level:(t&&t(),0)}const a=document.getElementById("startButton"),d=document.getElementById("welcomeLink"),o=document.getElementById("logsCount"),c=document.getElementById("logsLimit"),i=document.getElementById("deleteButton"),l=document.getElementById("upgradeButton"),r=document.getElementById("backButton"),m=document.getElementById("discordLink"),u=document.getElementById("subPlanFree"),E=document.getElementById("subPlanBasic"),L=document.getElementById("subPlanPremium"),g=document.getElementById("planType"),h=document.getElementById("planLevel"),y=document.getElementById("key"),p=["Free","Basic","Premium"],w=("undefined"!=typeof browser?browser:chrome).storage.local,b=[Math.round(Math.pow(22.36,2)),Math.round(Math.pow(44.72,2)),-1*Math.round(Math.pow(1,3))];var I=null;function B(){w.get(["key"],e=>{e.key?I=e.key:(I=Array.from({length:10},()=>"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(62*Math.random())]).join(""),w.set({key:I})),y&&(y.textContent=I),(h||c||l)&&s(I,()=>{l&&(l.classList.add("fullDisabled"),l.textContent="Online service unavailable")}).then(e=>{h&&(h.textContent=p[e]),c&&(c.textContent=-1==b[e]?" / Unlimited":" / "+b[e]),l&&(l.classList.contains("fullDisabled")||(l.classList.remove("disabled"),l.textContent="Upgrade",l.addEventListener("click",()=>{window.location.href="Plan.html?planLevel="+e})))})})}function k(){if(o&&w.get(["logsCount"],e=>{const t=e.logsCount||0;o.textContent=t,t>0?i.classList.remove("invisible"):i.classList.add("invisible")}),i&&i.addEventListener("click",()=>{chrome.runtime.sendMessage({type:"DELETE_ALL_LOGS_FROM_DISCORD_MESSAGE_LOGGER_POPUP"},e=>{e?.success&&(o.textContent="0")})}),r&&r.addEventListener("click",()=>{window.location.href="Index.html"}),m&&m.addEventListener("click",()=>{window.open("https://discord.gg/pUKDF2adMw","_blank")}),d&&d.addEventListener("click",()=>{chrome.tabs.create({url:chrome.runtime.getURL("Config/WelcomePage.html")})}),u&&u.addEventListener("click",()=>{u.classList.contains("disabled")||n(t.FREE)}),E&&E.addEventListener("click",()=>{E.classList.contains("disabled")||n(t.BASIC)}),L&&L.addEventListener("click",()=>{L.classList.contains("disabled")||n(t.PREMIUM)}),u||E||L){const e=new URLSearchParams(window.location.search),t=parseInt(e.get("planLevel"));if(!isNaN(t)){const e=[u,E,L];e[t]&&(e[t].classList.add("disabled"),e[t].textContent="Current plan",e[t]==L?E.classList.add("disabled"):e[t]==E&&L.classList.add("disabled"))}}if(g){const e=new URLSearchParams(window.location.search),t=parseInt(e.get("planLevel")),n=["Free","Basic","Premium"];g.textContent=n[t]}}a?a.addEventListener("click",()=>{window.open("https://discord.com/channels/@me","_blank")}):(B(),k());